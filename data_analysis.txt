-- 1. Severity Distribution: What is the count of vulnerabilities for different severity levels

SELECT Severity, COUNT(*) as Count
FROM CVE
GROUP BY Severity;


-- 2. Worst Products, Platforms : Find out the worst products, platforms with most number of known vulnerabilities

-- Worst Products
SELECT Product.Name, COUNT(*) as Count
FROM Product
JOIN Vulnerability_Product ON Product.Product_ID = Vulnerability_Product.Product_ID
GROUP BY Product.Name
ORDER BY Count DESC;

-- Worst Platforms
SELECT Platform.Name, COUNT(*) as Count
FROM Platform
JOIN Vulnerability_Platform ON Platform.Platform_ID = Vulnerability_Platform.Platform_ID
GROUP BY Platform.Name
ORDER BY Count DESC;


-- 3. List top 10 vulnerabilities that have the highest impact

SELECT CVE_ID, ImpactScore
FROM CVSSMetrics
ORDER BY ImpactScore DESC
LIMIT 10;


-- 4. List top 10 vulnerabilities that have the highest exploitability scores

SELECT CVE_ID, ExploitabilityScore
FROM CVSSMetrics
ORDER BY ExploitabilityScore DESC
LIMIT 10;


-- 5. List top 10 attack vectors used

SELECT AttackVector, COUNT(*) as Count
FROM CVSSMetrics
GROUP BY AttackVector
ORDER BY Count DESC
LIMIT 10;
